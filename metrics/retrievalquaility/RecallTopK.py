from typing import Iterable, Set

"""
Compute Recall@K for a ranked list of retrieved documents. Class was initialially generated by ChatGPT by ChatGPT and edited by github copilot
and then modified by the author to fit the codebase style to text in MA thesis also some comments were added.

Parameters
----------
retrieved_ids : iterable of str
    Ranked list of retrieved document IDs.
relevant_ids : iterable of str
    Collection of relevant document IDs.

Returns
-------
float
    Recall value in [0, 1].

"""

class RecallTopK:
    def __init__(self, k: int):
        if k <= 0:
            raise ValueError("k must be a positive integer")
        self.k = k

    def compute(
        self,
        retrieved_ids: Iterable[str],
        relevant_ids: Iterable[str],
    ) -> float:

        relevant_set: Set[str] = set(relevant_ids)
        
        if not relevant_set:
            return 0.0
        
        # Wandelt das Iterable `retrieved_ids` in eine Liste um und nimmt die
        # ersten `self.k` Elemente.
        top_k = list(retrieved_ids)[:self.k]
        
        # Bestimmt die Schnittmenge der relevanten IDs und der Top-K abgerufenen IDs.
        retrieved_relevant = relevant_set.intersection(top_k)

        # Berechnet den Recall-Wert als Verhältnis der gefundenen relevanten Dokumente
        # zu der Gesamtanzahl der relevanten Dokumente. Ergebnis wird als Float zurückgegeben und ist
        # im Bereich [0, 1]. 
        return len(retrieved_relevant) / len(relevant_set)
